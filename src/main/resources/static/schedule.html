<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>æ’èª²å·¥ä½œå°</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; height: 100vh; margin: 0; overflow: hidden; background-color: #f8f9fa; }
        
        .left-panel { flex: 3; padding: 20px; display: flex; flex-direction: column; }
        .grid-container { 
            display: grid; grid-template-columns: 60px repeat(5, 1fr); gap: 1px; 
            flex-grow: 1; margin-top: 10px; background: #ced4da; 
            border: 2px solid #ced4da; border-radius: 4px;
            user-select: none; 
        }
        .grid-header { background: #343a40; color: white; text-align: center; padding: 10px; font-weight: bold; }
        .period-label { background: #e9ecef; color: #495057; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        
        .grid-cell { 
            background: white; display: flex; align-items: center; justify-content: center; 
            position: relative; min-height: 50px; font-size: 16px; font-weight: bold; color: #333;
            cursor: pointer;
            flex-direction: column; /* è®“å°å­—å¯ä»¥æ›è¡Œé¡¯ç¤º */
        }
        .grid-cell:hover { filter: brightness(0.95); }
        .grid-cell.busy { 
            background-color: #e2e3e5 !important; color: #adb5bd;
            background-image: repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(0,0,0,0.05) 5px, rgba(0,0,0,0.05) 10px);
            cursor: not-allowed; pointer-events: none;
        }

        .right-panel { flex: 1; padding: 20px; background: white; border-left: 1px solid #ddd; display: flex; flex-direction: column; box-shadow: -4px 0 15px rgba(0,0,0,0.05); }
        .course-pool { flex-grow: 1; overflow-y: auto; padding-right: 5px; }
        
        .pool-item { 
            padding: 12px 15px; margin-bottom: 10px; border-radius: 8px; cursor: pointer; 
            display: flex; justify-content: space-between; align-items: center;
            font-weight: bold; transition: all 0.1s; border: 3px solid transparent;
            color: #555; background-color: #f1f3f5;
        }
        .pool-item:hover { background-color: #e9ecef; }
        .pool-item.active { border-color: #333; background-color: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transform: scale(1.02); }
        .pool-item.empty { opacity: 0.5; filter: grayscale(100%); }
        
        .badge { background: #6c757d; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; }
        .badge.done { background: #28a745; }

        .btn-save { background: #28a745; color: white; border: none; padding: 15px; width: 100%; font-size: 18px; cursor: pointer; margin-top: 10px; border-radius: 8px; transition: background 0.2s; }
        .btn-back { background: #6c757d; color: white; border: none; padding: 10px; width: 100%; margin-top: 5px; cursor: pointer; border-radius: 8px; }
        
        .toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .eraser { cursor: pointer; padding: 8px 15px; border: 1px solid #ddd; border-radius: 20px; background: #fff; user-select: none; font-size: 14px; display: flex; align-items: center; gap: 5px; }
        .eraser.active { background: #ffc107; border-color: #e0a800; font-weight: bold; color: #856404; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

    <div class="left-panel">
        <div class="toolbar">
            <h2 style="margin:0;">ğŸ“… æ’èª²å·¥ä½œå° <span id="teacherName" style="font-size:0.6em; color:#666; font-weight:normal;"></span></h2>
            <div id="eraserBtn" class="eraser" onclick="selectEraser()">
                <span style="font-size: 1.2em;">ğŸ§¹</span> æ©¡çš®æ“¦
            </div>
        </div>
        <div class="grid-container" id="scheduleGrid"></div>
    </div>

    <div class="right-panel">
        <h3 style="margin-top:0;">ğŸ¨ èª²ç¨‹ç•«ç­†</h3>
        <p style="font-size:13px; color:#666;">é»é¸å³å´èª²ç¨‹ï¼Œç„¶å¾Œåœ¨å·¦å´æ ¼å­æ»‘å‹•</p>
        <div class="course-pool" id="coursePool"></div>
        <button class="btn-save" onclick="saveSchedule()">ğŸ’¾ å„²å­˜èª²è¡¨</button>
        <button class="btn-save" style="background-color: #6f42c1; margin-top: 5px;" onclick="autoSchedule()">ğŸª„ è‡ªå‹•æ’èª²</button>
        <button class="btn-back" onclick="location.href='login.html'">å›ç™»å…¥é </button>
        <button class="btn-back" onclick="location.href='availability.html'">å›è¨­å®šé </button>
    </div>
 
    <script src="js/schedule.js"></script>

    <div id="chatModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:white; width:400px; border-radius:12px; overflow:hidden; box-shadow:0 10px 25px rgba(0,0,0,0.2); display:flex; flex-direction:column;">
            
            <div style="background:#0d6efd; color:white; padding:15px; font-weight:bold; display:flex; justify-content:between; align-items:center;">
                <span>ğŸ’¬ ä¾†è‡ªç§‘ä»»è€å¸«çš„è¨Šæ¯</span>
                <span onclick="closeChat()" style="cursor:pointer; font-size:1.2em;">&times;</span>
            </div>

            <div id="chatContent" style="padding:20px; height:250px; overflow-y:auto; background:#f0f2f5; display:flex; flex-direction:column; gap:10px;">
                </div>

            <div style="padding:15px; border-top:1px solid #ddd; background:white; text-align:right;">
                <button onclick="closeChat()" style="background:#0d6efd; color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer;">çŸ¥é“äº†ï¼Œæˆ‘ä¾†æ‰‹å‹•æ’</button>
            </div>
        </div>
    </div>
</body>
</html>